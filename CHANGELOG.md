# Changelog

## Unreleased
- Rebooting Reaper Bot from a clean baseline.
- Focusing first on community-reported issues.
- Feature: Platform riding for func_train (DM2 lava fix - bots inherit platform velocity).
- Feature: Platform wait logic (bots wait for approaching platforms over lava).
- Feature: Intelligent button interaction (bots find and shoot/touch buttons to open doors).
- Fixed: Single player crash to DOS caused by edict overflow (waypoint cap reduced to 50 in SP).
- Fixed: Multiplayer lockups from exponential route cache recursion (added cycle detection).
- Fixed: Potential hang from infinite jump simulation into void (added safety counter).
- Fixed: Crash when adding bots beyond maxplayers (scoreboard overflow guard).
- Fixed: Jumpy/teleport-like strafing (removed sub-frame timing, added velocity for interpolation).
- Improved: Movement smoothing (Z-axis ground glue, zero velocity on collision, consistent 0.1s think timing).
- Feature: Humanized idle behavior (BotRoam makes bots wander and scavenge instead of freezing).
- Fixed: "Flashing" bots near water (stricter teleptest checks).
- Fixed: Bots getting stuck running in place (time-based tracking, 1.5s forced goal change, 20% jump chance).
- Fixed: Camper behavior near best weapons (ignore owned weapons when ammo sufficient).
- Fixed: Suicidal explosive firing (switch weapons when enemy <150 units).
- Fixed: Thunderbolt water discharge (switch weapons when in water).
- Improved: Predictive aiming (capped lead time to 0.5s to prevent over-leading).
- Fixed: Bots walking into lava/slime (hazard avoidance with powerup awareness).
- Fixed: Bots walking off lifts mid-ride (platform state detection).
- Fixed: Bots stuck at closed doors (trigger door and back up to let it open).
- Fixed: Bots ganging up on players (closest-target selection now uses checkclient + cached bot list).
- Fixed: "Vacuum pickup" where items vanished before bot reached them (added distance check).
- Investigated: "Extra SNG ammo" complaint (not found in baseline - bots use same ammo as players).
- Investigated: "Firing faster" complaint (not found - bots use identical attack timings as players).
- Fixed: Low-skill bots felt like cheaters (increased aim jitter from ~10° to ~25° max at skill 0).
- Fixed: Bots attacking observers/spectators (added MOVETYPE_NOCLIP and deadflag checks).
- Fixed: Bots not affected by explosion knockback (velocity preservation when airborne).
- Fixed: Bot knockback now uses bounce physics to avoid embedding; restores step mode when settled.
- Improved: sv_aim warning now prints the current value and expected baseline.
- Feature: Added tactical retreat fallback when running away and no goodies are found.
- Refactor: Centralized run logic via `BotAI_Main` during shot/axe frames to reduce tunnel vision.
- Optimization: BotFindTarget scans players via checkclient and bots via cached list to avoid full entity walks.
- Fixed: Suppressed `Bot should be dead!` log spam by skipping BotPostThink on dead bots.
- Improved: Pain reflex triggers immediate bot reaction when taking damage from a player/bot.
- Improved: Added a developer-only `KNOCKBACK_END` log when bots return to step movement.
- Improved: Range-based weapon selection with close-quarters combat logic (< 150 units: SNG > SSG > LG > NG > SG, explosives only with Quad; standard range: LG > RL > SNG > GL mid-range only > SSG; long range: prefer nails over shotguns).
- Improved: Added developer-only AI state logging in `BotAI_Main` (logs only on state changes).
- Fixed: Zero-velocity knockback causing stuck/jittery bots (require velocity > 50 before entering MOVETYPE_BOUNCE AND resetting knockback timer - prevents recovery timer from being reset by zero-velocity hits).
- Improved: KNOCKBACK log now filters zero-velocity entries and debounces duplicates (0.05s) to reduce console spam.
- Fixed: GOODY/RETREAT AI oscillation (added 0.5s hysteresis to prevent rapid state flipping).
- Fixed: Stale knockback/AI state after respawn (reset values in PutBotInServer).
- Fixed: Backpacks spawning in unreachable locations (CONTENT_SOLID/SKY check).
- Fixed: sv_aim warning spam (one-time flag per map).
- Feature: Unlocked high skill levels (skill 0-10, was 0-3).
- Feature: Added impulse 100 quick-add bot (standard convention).
- Investigated: "Respawn splash sound" (not found - spawn uses correct teleport sounds).
- Investigated: "Floating after respawn" (not found - spawn already uses MOVETYPE_STEP).
- Updated development and launch docs for the `mre/` layout.
- CI now builds from `mre/` via `ci/build_mre.ps1`.
- Archived legacy docs/tools/launch assets and old logs under `archive/legacy/clean_slate/`.
